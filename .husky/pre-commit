#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Type check
echo "ğŸ“ Type checking..."
npm run typecheck
if [ $? -ne 0 ]; then
  echo "âŒ Type check failed"
  exit 1
fi

# Lint
echo "ğŸ§¹ Linting..."
npm run lint
if [ $? -ne 0 ]; then
  echo "âŒ Lint failed"
  exit 1
fi

# Format check
echo "ğŸ¨ Format checking..."
npm run format:check
if [ $? -ne 0 ]; then
  echo "âŒ Format check failed"
  exit 1
fi

# Build
echo "ğŸ”¨ Building..."
npm run build
if [ $? -ne 0 ]; then
  echo "âŒ Build failed"
  exit 1
fi

# Test
echo "ğŸ§ª Testing..."
npm run test
if [ $? -ne 0 ]; then
  echo "âŒ Tests failed"
  exit 1
fi

# Test CI environment (without env vars)
echo "ğŸ§ª Testing CI environment..."
npm run test:ci
if [ $? -ne 0 ]; then
  echo "âŒ CI tests failed"
  exit 1
fi

echo "âœ… All checks passed!"
